import{d as T,B as q,I as B,G as L,r as p,y as N,a as u,m as g,w,c as h,e as a,t as r,D as d,E as m,u as v,k as c,f as P,i as U,K as y}from"./index.855284fc.js";import{_ as C}from"./BaseButton.vue_vue_type_script_setup_true_lang.8c6a2ef1.js";import{_ as R}from"./BaseForm.vue_vue_type_script_setup_true_lang.cfd44047.js";const D={key:0},O={for:"email"},G=["placeholder"],M={key:1},K={for:"name"},W=["placeholder"],j={for:"surname"},z=["placeholder"],A={for:"password"},H=["placeholder"],J={for:"acceptToc"},Q=a("input",{type:"checkbox",id:"acceptToc",name:"acceptToc",required:""},null,-1),X={href:"/terms-of-service",target:"_blank"},Y={href:"/privacy-policy",target:"_blank"},Z={key:2},x={for:"password"},ee=["placeholder"],re=T({__name:"LoginOrRegister",emits:["success"],setup(se,{emit:_}){const t=q(),{t:k}=B(),o=L({name:"",surname:"",password:""}),l=p(!1),f=p(!1),$=p(""),i=p(),E=async()=>{if(!t.userEmail)return;const e=await t.checkEmail(t.userEmail);if(typeof e!="boolean"){alert(e.data.message);return}f.value=!e,$.value="",l.value=!0},b=async()=>{if(!t.userEmail)return;await t.login(t.userEmail,o.password)===!1?(i.value.setInputErrors({password:k("Invalid email or password")}),o.password=""):_("success")},I=async()=>{if(!t.userEmail)return;const e=await t.register(t.userEmail,o.password,o.name,o.surname);if(e!==!0)if(e.data){const s=await e.data;s.errors.email&&(l.value=!1),await y(),i.value.setInputErrors(s.errors)}else l.value=!1,await y(),i.value.setInputErrors({email:"Something went wrong"});else _("success")},V=async()=>{t.userEmail&&!l.value?(await E(),i.value.focusOnFirstInput()):f.value?await I():await b()},S=async()=>{l.value=!1,await y(),i.value.focusOnFirstInput()};return(e,s)=>{const F=N("RouterLink");return u(),g(R,{ref_key:"baseForm",ref:i,onSubmit:V,isLoading:v(t).isLoading},{default:w(()=>[l.value?f.value?(u(),h("fieldset",M,[a("label",K,r(e.$t("Name")),1),d(a("input",{type:"text",id:"name",name:"name",placeholder:e.$t("Name"),"onUpdate:modelValue":s[1]||(s[1]=n=>o.name=n),minlength:"2",pattern:".{2,}",autocomplete:"given-name",autofocus:"",required:""},null,8,W),[[m,o.name]]),a("label",j,r(e.$t("Surname")),1),d(a("input",{type:"text",id:"surname",name:"surname",placeholder:e.$t("Surname"),"onUpdate:modelValue":s[2]||(s[2]=n=>o.surname=n),minlength:"2",pattern:".{2,}",autocomplete:"family-name",required:""},null,8,z),[[m,o.surname]]),a("label",A,r(e.$t("Password")),1),d(a("input",{type:"password",id:"password",name:"password",placeholder:e.$t("Password"),"onUpdate:modelValue":s[3]||(s[3]=n=>o.password=n),minlength:"5",pattern:".{5,}",autocomplete:"new-password",required:""},null,8,H),[[m,o.password]]),a("label",J,[Q,c(" "+r(e.$t("I accept the"))+" ",1),a("a",X,r(e.$t("Terms of Service")),1),c(" "+r(e.$t("and"))+" ",1),a("a",Y,r(e.$t("Privacy Policy")),1)])])):(u(),h("fieldset",Z,[a("label",x,r(e.$t("Password")),1),d(a("input",{type:"password",id:"password",name:"password",placeholder:e.$t("Password"),"onUpdate:modelValue":s[4]||(s[4]=n=>o.password=n),minlength:"1",pattern:".{1,}",autocomplete:"current-password",autofocus:"",required:""},null,8,ee),[[m,o.password]]),P(F,{to:"/forgot-password"},{default:w(()=>[c(r(e.$t("Forgot password?")),1)]),_:1})])):(u(),h("fieldset",D,[a("label",O,r(e.$t("Email")),1),d(a("input",{type:"email",id:"email",name:"email",placeholder:e.$t("Email"),"onUpdate:modelValue":s[0]||(s[0]=n=>v(t).userEmail=n),pattern:"[^@]+@[^@]+\\.[^@]+",autofocus:"",required:""},null,8,G),[[m,v(t).userEmail]]),a("small",null,r(e.$t("We'll never share your email with anyone else.")),1)])),l.value?(u(),g(C,{key:3,class:"secondary","data-cy":"back",onClick:s[5]||(s[5]=n=>S())},{default:w(()=>[c(r(e.$t("Go back")),1)]),_:1})):U("",!0)]),_:1},8,["isLoading"])}}});export{re as _};

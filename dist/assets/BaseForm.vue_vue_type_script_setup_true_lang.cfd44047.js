import{d as F,r as p,J as j,K,L as $,a as I,c as q,b as g,u as E,M as f,j as N,h as S,m as D,w as H,k as J,t as P,i as U}from"./index.855284fc.js";import{_ as z}from"./BaseButton.vue_vue_type_script_setup_true_lang.8c6a2ef1.js";const G=["onKeydown","onSubmit"],W=F({__name:"BaseForm",props:{submitText:{type:String,default:"Submit"},endpoint:{type:String,required:!1},clearInputTypesOnFailure:{type:Array,default:()=>["password"]},disabled:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},showSubmitButton:{type:Boolean,default:!0},autoFocus:{type:Boolean,default:!0}},emits:["submit"],setup(n,{expose:L,emit:O}){const d=n,a=p(),r=p(!1),l=()=>{var e,t;u(s=>{!s.validity.valid&&!s.validity.valueMissing&&!M(s)?y(s):b(s)}),r.value=(t=(e=a.value)==null?void 0:e.checkValidity())!=null?t:!1},y=e=>{let t=e.nextElementSibling;(!t||!t.classList.contains("error"))&&(t=document.createElement("small"),e.after(t)),t.innerText=e.validationMessage,t.classList.add("error"),e.insertAdjacentElement("afterend",t)},b=e=>{const t=e.nextElementSibling;t&&t.classList.contains("error")&&t.remove()},m=async()=>{r.value&&!d.isLoading&&!f.value&&!d.disabled&&O("submit")},u=e=>{var s;if(!((s=a.value)!=null&&s.elements))return;const t=a.value.elements;for(let i=0;i<t.length;i++){const o=t[i];o instanceof HTMLInputElement&&e(o)}},h=e=>{var t;for(const[s,i]of Object.entries(e)){const o=(t=a.value)==null?void 0:t.elements.namedItem(s);if(o){let c=i;Array.isArray(c)&&(c=c.join(" ")),T(o,c)}}},T=(e,t,s=!0)=>{e.setCustomValidity(t),e.setAttribute("aria-invalid","true"),s&&e.reportValidity(),y(e)},k=()=>{u(e=>{w(e)}),setTimeout(()=>{B()},5e3)},w=e=>{e.setAttribute("aria-invalid","false")},B=()=>{u(e=>{V(e)})},V=e=>{e.validity.valid&&e.removeAttribute("aria-invalid")},x=e=>{e.setCustomValidity(""),b(e)},A=()=>{u(e=>{x(e)})},M=e=>document.activeElement===e;j(async()=>{await K(),l()}),$(()=>{l(),!document.querySelector(":focus")&&d.autoFocus&&v()});const v=()=>{var t;const e=(t=a.value)==null?void 0:t.querySelector("input");e&&e.focus()},C=()=>{A(),l()};return L({checkValidity:l,setInputErrors:h,focusOnFirstInput:v,setSuccessOnInputs:k}),(e,t)=>(I(),q("form",{ref_key:"formElement",ref:a,onInput:C,onKeydown:N(S(m,["prevent"]),["enter"]),onSubmit:S(m,["prevent"])},[g(e.$slots,"default"),g(e.$slots,"submit",{submitText:n.submitText,submit:m,disabled:!r.value||n.disabled||n.isLoading||E(f),isLoading:n.isLoading},()=>[n.showSubmitButton?(I(),D(z,{key:0,type:"submit",disabled:!r.value||n.disabled||n.isLoading||E(f),"aria-busy":n.isLoading},{default:H(()=>[J(P(e.$t(n.submitText)),1)]),_:1},8,["disabled","aria-busy"])):U("",!0)])],40,G))}});export{W as _};
